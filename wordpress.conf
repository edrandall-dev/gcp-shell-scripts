<VirtualHost *:80>
        ServerName edrandall.uk
        ServerAlias www.edrandall.uk

        DocumentRoot /var/www/wordpress

        RewriteEngine on
        RewriteCond %{HTTP_HOST} ^www.edrandall\.uk
        RewriteRule ^(.*)$ https://edrandall.uk$1 [R=permanent,L]
        
        #Need this to get wordpress to serve http back to the LB
        #Otherwise it gets confused because the original request is https
        #and pages appear to get stripped of their css.
        <IfModule mod_setenvif.c>
          SetEnvIf X-Forwarded-Proto "^https$" HTTPS
        </IfModule>

        <Directory /var/www/wordpress>
          Options Indexes FollowSymLinks MultiViews
          AllowOverride All
          Require all granted
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/wrdprs-error.log
        CustomLog ${APACHE_LOG_DIR}/wrdprs-access.log combined

</VirtualHost>


